上节我们把 2D 视图画出来了：

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dec1786c752448a9a8b903843b8adada~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1474&h=1184&s=377093&e=png&b=add9e6)

但它有些偏差。

为啥会有偏差呢？

用的同一份数据，3D 视图对了那应该 2D 视图也一样才对。

先用那个简单的户型，注释掉地板，看一下：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bb10ba9f151b43b781aefa8073919c55~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1358&h=880&s=159916&e=png&b=1e1e1e)


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6806defa4d544d49cff1afa15d143dd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1260&h=906&s=24717&e=png&b=add9e6)

现在是有偏差的，但你把每面墙旋转 180 度：


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3daa0029fc4d44aa8e8095a619d96377~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1192&h=660&s=125845&e=png&b=1f1f1f)


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c63cc4c110d34b3c9fc01cf52984cf7b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1944&h=1330&s=46259&e=png&b=add9e6)

你会发现它们虽然位置不对，但是之前的缺口能对上了。

也就是说之前的问题在于画出的 Shape 正好是反着的，只要把它翻转下就好了。

形状反了，那位置也得反过来才行。


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df553ee7c9a14a00ad844e23e0497fdc~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1532&h=826&s=145540&e=png&b=1f1f1f)

```javascript
wall.position.set(-item.position.x, -item.position.y, -item.position.z);
```
设置相反的位置。

看下效果：


![2025-06-26 15.02.23.gif](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/269c551522e64f51bada2ac177ab500c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=2109707&e=gif&f=26&b=a3d1e2)

现在就对上了。

也就是说，**当画出的 Shape 反着的时候，可以让它旋转 180 度，位置设置相反数，这样就正过来了。**

当然，另一种方式就是改一下绘制逻辑，比如本来是第一种顺序，改成第二种自然就反过来了：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0c435afefe414966bf425999462d0238~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1540&h=564&s=35110&e=png&b=ffffff)

这里我们绘制逻辑就不改了，翻转一下就行。

然后把地板放出来：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2b0c8deebc04a8d823d98757402ee91~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=968&h=652&s=77558&e=png&b=1f1f1f)

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/63646a8fc4364e948e8f7399b8d7c52b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2104&h=1390&s=595719&e=png&b=add9e6)

地板位置不对，这个也是旋转下就好了。


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/603908bfdc09477ca95d0bf31f97db1e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1212&h=618&s=104323&e=png&b=1f1f1f)


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d48c6aa63374b6c95c1dfe883598d4e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1686&h=1174&s=584542&e=png&b=add9e6)

现在位置就对了。

最后剩下那个地板和墙重合的问题，纯粹是数值问题。

其实 3D 视图也有这个问题：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c819468a001488e838fd8f2a628cc63~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=996&h=512&s=92274&e=png&b=1f1f1f)


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8de34d05be1548ad901ac5097e970bbb~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1112&h=832&s=148665&e=png&b=1f1f1f)

关掉墙隐藏，把地板改成双面可见。

看下效果：


![2025-06-26 15.10.14.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ae5d2e7904341fbb42e90acd21ba2c3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=10643657&e=gif&f=13&b=83c8e6)

可以看到，在 3D 视图的墙和地板就是重合的，只不过我们之前只从上往下看，没注意到。

我们改一下数值：

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/115a3c1df66d4f66add4fa1170bb1af7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=856&h=636&s=74334&e=png&b=1f1f1f)

```javascript
points: [
    { x: 0, z: 0},
    { x: 0, z: 6800},
    { x: 4800, z: 6800},
    { x: 4800, z: 0},
    { x: 0, z: 0 }
]
```
就是把墙面的 200 厚度留出来。

然后绘制的时候也要设置下位置：

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6004ce4843ed4360ad3c375e6d7d770b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1194&h=628&s=129019&e=png&b=1f1f1f)

```javascript
floor.position.y = 200;
floor.position.z = 200;
```

![2025-06-26 15.20.02.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/820569b847bb47a9a3ea6bb75145addd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=7872168&e=gif&f=15&b=81c8e6)

现在大小就正好了。

但现在 2D 视图的位置也不大对，也调一下：

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d06d4d6caeb421a8bfb0bd31654373f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1782&h=1190&s=549933&e=png&b=add9e6)

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8596fb16cd164e73b663414c927a757a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=970&h=550&s=86905&e=png&b=1f1f1f)

```javascript
floor.position.z = -200;
```

![2025-06-26 15.23.35.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec9a17fe626343e9a45f602d214b13e1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=11256368&e=gif&f=33&b=a3d1e1)

现在 2D、3D 视图就都对了。

然后切换到另一个户型看下：

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9f258d8b6a4549659e3467b7be483a64~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=820&h=248&s=38687&e=png&b=1f1f1f)


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bea01ffb44f14dd796fa02b6930c0759~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1062&h=794&s=109590&e=png&b=1f1f1f)

同样先把地板注释掉。


![2025-06-26 15.27.03.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/388ddcb34ec74070b00435f6d454cbd5~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=2428745&e=gif&f=20&b=86cae7)

墙是对的。

地板也按照去掉墙面的 200 厚度来调整下数据：

```javascript
floors: [
    {
        points: [
            { x: -2000, z: 5000},
            { x: -5000, z: 5000},
            { x: -5000, z: 6680},
            { x: -2000, z: 6680},
            { x: -2000, z: 5000},
        ],
    },
    {
        points: [
            { x: 0, z: 0},
            { x: 2680, z: 0},
            { x: 2680, z: 6900},
            { x: 680, z: 6900},
            { x: 680, z: 8100},
            { x: -2000, z: 8100},
            { x: -2000, z: 6680},
            { x: -2000, z: 5000},
            { x: -2000, z: 5000},
            { x: 0, z: 5000},
            { x: 0, z: 0},
        ],
        textureUrl: './floor-texture2.png'
    }
],
```
看下效果：

![2025-06-26 15.43.24.gif](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c00d6eff832944b0ac2bbe28887e73f7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=9246539&e=gif&f=27&b=a3d1e1)

这样，2D、3D 视图就都对了。

把地板改回单面：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e2f46833cf0e4653884638f57a1f788a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1094&h=526&s=100523&e=png&b=1f1f1f)

开启墙隐藏：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c3c2c50608914e75956e2b02f150e41d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=832&h=576&s=96843&e=png&b=1f1f1f)


![2025-06-26 15.45.42.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/571310171a384f258184d11278b933ea~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=19599892&e=gif&f=47&b=e8f5fc)

最后我们再调节一些细节：

2D 视图也设置一样的环境光强度：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf7e67c2ad1f4cf79b33aff8db212337~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1344&h=516&s=122087&e=png&b=1f1f1f)


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a81d1de5a26d4afda69ffdab1eeea38d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1664&h=1236&s=356103&e=png&b=add9e6)

还有之前没有注释掉这个：


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d6f386db38d54bdb99efb1b5b6e1e7f6~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1330&h=590&s=138020&e=png&b=1f1f1f)

注释掉之后旋转角度就不对了：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/846a2cc969304c7ab516b50cf4bbd7b7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1886&h=1406&s=455984&e=png&b=add9e6)

改成 90：


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc939b52a02145d0bd828a4201c1d3fd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1174&h=476&s=92447&e=png&b=1f1f1f)

看下调整好的效果：

![2025-06-26 15.52.24.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7509196ebb9d4ecba48ddeb80d8d3405~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=14441352&e=gif&f=41&b=87cae7)

没啥问题。

>案例代码上传了[小册仓库](https://github.com/QuarkGluonPlasma/threejs-course-code/tree/main/home-decoration-editor)


## 总结

这节我们修复了 2D 视图绘制时的误差。

有两个原因：

一个是 2D 视图绘制的形状是反着的，所以我们要旋转 180 度，然后把位置设置相反数，这样就反过来了。

另一个之前绘制地板没有把墙的厚度考虑进度，我们调整了下地板的点，还有绘制的起始位置就好了。

2D 视图的问题修复了，下节继续加上门窗、尺寸的绘制。
