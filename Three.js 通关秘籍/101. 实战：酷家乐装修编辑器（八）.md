门窗绘制好了，这节来绘制地板、天花板：

![2025-06-18 18.54.45.gif](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af1d2fc9951e4b7a8a7ebe390c9f5f3f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2700&h=1464&s=300169&e=gif&f=14&b=fbf6df)

酷家乐里，除了墙、门窗、也绘制了地板、天花板：

![2025-06-18 19.13.50.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/54b4077b23984219828279e60b356a34~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2700&h=1464&s=6218685&e=gif&f=46&b=f1f4f6)

你可以用一下酷家乐个人版 https://www.kujiale.com/ 体验下，免费用。

相机从下往上看的时候可以看到天花板：

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/338545dfa6e24ee09159379fb658430f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1774&h=1192&s=809164&e=png&b=cbe4f3)

从上往下看则是看到地板：

![2025-06-18 19.16.01.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0dcd7f3d5544346922a3396b7a2830a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2700&h=1464&s=6321797&e=gif&f=26&b=e5f0f5)

并且客厅、卧室、洗手间的地板材料都不同：

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ff480dbdc4844f4979174850d9edb85~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1560&h=1222&s=1593604&e=png&b=e0d7d4)

很明显，我们也要单独存储每个房间的地板数据。

在 store 里加一个 floors 数组：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9b4a4e2da88643fd86a31beafd1f1f5b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1174&h=858&s=96535&e=png&b=1f1f1f)

```javascript
floors: [
    {
        points: [
            { x: 0, z: 0},
            { x: 0, z: 800},
            { x: 800, z: 800},
            { x: 800, z: 0},
            { x: 0, z: 0 }
        ]
    }
]
```
因为地板的形状是不规则的：

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78ee457d2a1e47358882a904909a54ad~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=784&h=1056&s=786278&e=png&b=dbd1cb)

所以要存储一系列的点。

y 都是 0，所以存储 x、z 就好。

类型也加一下：


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d0c91e65c444d0581c26ed5dfdea3c1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=668&h=856&s=83711&e=png&b=1f1f1f)

```javascript
interface Floor {
    points: Array<{
        x: number,
        z: number
    }>
}

interface State {
    data: {
        walls: Array<Wall>,
        floors: Array<Floor>
    }
}
```
然后我们把它绘制出来：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/597d52a2a0aa407a918d7492e2bb998d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1330&h=1146&s=219281&e=png&b=1f1f1f)

用 Shape 把所有的点依次连起来，然后用 ShapeGeometry 画出形状。

```javascript
const floors = data.floors.map(item => {
    const shape = new THREE.Shape();
    shape.moveTo(item.points[0].x, item.points[0].z);
    for(let i = 1; i < item.points.length; i++) {
        shape.lineTo(item.points[i].x, item.points[i].z);
    }

    const geometry = new THREE.ShapeGeometry(shape);
    const material = new THREE.MeshPhongMaterial({
        color: 'orange'
    });
    const floor = new THREE.Mesh(geometry, material);

    return floor;
});
scene.add(...floors);
```

看下效果：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5532ce8dcec04f5d85c718c4330c07a6~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1684&h=1408&s=210539&e=png&b=f9f4e3)

可以看到，形状画出来了，但是角度不对。

设置旋转角度和背面可见：

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ebf188a509d4cb7b0fe66d6293bcedd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1114&h=972&s=167179&e=png&b=1f1f1f)

```javascript
const material = new THREE.MeshPhongMaterial({
    color: 'orange',
    side: THREE.BackSide
});
const floor = new THREE.Mesh(geometry, material);
floor.rotateX(Math.PI / 2);
```

![2025-06-19 06.13.28.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c1a6f028d1040f8901d90228c7d8353~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2700&h=1464&s=1509148&e=gif&f=44&b=fbf3e5)

这样就好了。

我们找个地板的纹理图片，默认用木质地板。


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/00ed0753a55d4c59be26882f9c9d023e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2602&h=1242&s=3448389&e=png&b=ede0dc)


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1df570d6bade4dfb963d5865aaaf94bf~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1024&h=1024&s=2176461&e=png&b=daa876)

放 public 目录下：

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1092904f994543309cbee3d5816a79ef~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1776&h=844&s=1186079&e=png&b=1c1c1c)

代码里加载下：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7366614eaa047e9a4c516d5a086b3d4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1262&h=630&s=137390&e=png&b=1f1f1f)

因为 ShapeGeometry、ExtrudeGeometry 这种画出来的几何体的 uv 值都特别大，所以要设置一个比较小的 repeat 才能正常展示出纹理。

```javascript
const textureLoader = new THREE.TextureLoader();
const floorTexture = textureLoader.load('./floor-texture.png');
floorTexture.colorSpace = THREE.SRGBColorSpace;
floorTexture.wrapS =  THREE.RepeatWrapping;
floorTexture.wrapT =  THREE.RepeatWrapping;
floorTexture.repeat.set(0.002, 0.002);
```


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/05fbe090683c43298dcfcc6d4fbe8f58~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1244&h=776&s=131821&e=png&b=1f1f1f)

看下效果：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c43a8fde58445a5af27a6e88e2c6e75~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1452&h=1068&s=274408&e=png&b=faf6e0)

没问题。

你可以打印下 geometry 看下 uv 数组就明白了：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2d468ce0e7f41cfa5ac065b13e3d413~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1128&h=790&s=134982&e=png&b=1f1f1f)


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd4d42ac4dc94ba095ea0b6143842038~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2210&h=1018&s=402464&e=png&b=f7f0ec)

uv 数组的值都特别大，要设置一个很小的 repeat 才能刚好是 0 到 1，也就是正常映射纹理。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe0e2a9002dd4e08ac16cf1cac85527f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1028&h=680&s=486375&e=png&b=ffffff)

地板画好后，继续来画天花板：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c58400c6eca1476b8876bb8d74c113d1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1158&h=1002&s=126206&e=png&b=1f1f1f)

```javascript
ceilings: [
    {
        points: [
            { x: 0, z: 0},
            { x: 0, z: 800},
            { x: 800, z: 800},
            { x: 800, z: 0},
            { x: 0, z: 0 }
        ],
        height: 500
    }
]
```
数据这里多一个 height，也就是天花板高度。

加下类型：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/779a3986c6b74982b031de77831b18b4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=830&h=722&s=83698&e=png&b=1f1f1f)

```javascript
interface Ceiling {
    points: Array<{
        x: number,
        z: number
    }>,
    height: number
}

interface State {
    data: {
        walls: Array<Wall>,
        floors: Array<Floor>,
        ceilings: Array<Ceiling>
    }
}
```

然后画出来：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b867c5bd80d4432c94485e5ece82f4de~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1330&h=1128&s=228788&e=png&b=1f1f1f)

```javascript
const ceilings = data.ceilings.map(item => {
    const shape = new THREE.Shape();
    shape.moveTo(item.points[0].x, item.points[0].z);
    for(let i = 1; i < item.points.length; i++) {
        shape.lineTo(item.points[i].x, item.points[i].z);
    }

    const geometry = new THREE.ShapeGeometry(shape);
    const material = new THREE.MeshPhongMaterial({
        color: '#eee',
        side: THREE.FrontSide
    });
    const ceiling = new THREE.Mesh(geometry, material);
    ceiling.rotateX(Math.PI / 2);
    ceiling.position.y = item.height;
    return ceiling;
});
scene.add(...ceilings);
```
颜色比墙深一点，然后设置下 position.y，其余部分一样。


![2025-06-19 06.41.08.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d18c8ebabf2546048410fa50d34225fb~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2700&h=1464&s=677142&e=gif&f=26&b=fbf3e7)

这样天花板就画好了。

因为设置了单面可见，所以从上往下看，看不到天花板，从下网上看，看不到地板。

和酷家乐这个是一样的：

![2025-06-18 19.13.50.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/54b4077b23984219828279e60b356a34~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2700&h=1464&s=6218685&e=gif&f=46&b=f1f4f6)

>案例代码上传了[小册仓库](https://github.com/QuarkGluonPlasma/threejs-course-code/tree/main/home-decoration-editor)

## 总结

这节我们绘制了地板、天花板。

存储一系列的点，用 Shape 画形状，然后用 ShapeGeometry 画出来。

设置单面可见，这样就可以实现从上往下、从下往上只能看到地板或天花板。

墙、门、窗、地板、天花板都完成了，下节就可以来写两室一厅等户型了。
