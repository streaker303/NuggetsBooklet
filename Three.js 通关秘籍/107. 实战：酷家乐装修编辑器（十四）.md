上节修复了 2D 视图绘制的一些问题：

![2025-06-26 15.52.24.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7509196ebb9d4ecba48ddeb80d8d3405~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=14441352&e=gif&f=41&b=87cae7)

这节我们继续来绘制 2D 视图的门窗。

在酷家乐里面，门和床的标志如下：

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/394748f5db3740dd87a92a692e08a401~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1096&h=792&s=344766&e=png&b=eef0f1)

我们也这样来画。

首先，需要把缺口留出来：

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/82304d7941d9497fa1af50f0720829e1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1294&h=1016&s=225047&e=png&b=1f1f1f)

这里和 3D 视图还不一样，我们是从 left 到 left + win.width 来挖洞，直接挖穿：

```javascript
item.windows?.forEach(async win => {
    const path = new THREE.Path();

    const { left } = win.leftBottomPosition;

    path.moveTo(left, 0);
    path.lineTo(left, item.depth);
    path.lineTo(left + win.width, item.depth);
    path.lineTo(left + win.width, 0);
    path.lineTo(left, 0);
    shape.holes.push(path);
})
```
看下效果：


![2025-06-26 20.20.23.gif](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee2880b14c5f43e2bd6bdaf413ab56a1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=1941942&e=gif&f=29&b=a6d2e2)

再看下另一个户型：


![2025-06-26 20.21.17.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f629d74542024594b41b42c446c4e660~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=8881414&e=gif&f=31&b=a4d1e2)

也没啥问题。

然后我们在洞的位置画一个窗户标志就可以了。


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21b293c182594ae89cfc419b39d7b570~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=956&h=718&s=337927&e=png&b=cab69b)

我们用 PlaneGeometry 来画：

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d25519b64634bf58b7342c5c34c4b34~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1646&h=856&s=212768&e=png&b=1f1f1f)

```javascript
item.windows?.forEach(win => {
    const geometry = new THREE.PlaneGeometry(win.width, item.depth);
    const material = new THREE.MeshBasicMaterial({
        color: 'green',
        side: THREE.DoubleSide
    });
    const winLogo = new THREE.Mesh(geometry, material);
    wall.add(winLogo);
})
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a647d84164af4e7ebcad9628166a575e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1256&h=778&s=519938&e=png&b=add9e6)

它的中心点在最左边，所以应该移动 left +  win.width / 2，这样刚好把中心点移动洞的中间。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af2f0cc3fa7841249da298fd70190278~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1182&h=738&s=135406&e=png&b=1f1f1f)

```javascript
const { left } = win.leftBottomPosition;
```
```javascript
winLogo.position.x = left + win.width / 2
winLogo.position.y = 100;
```
看下效果：


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d59f0143d6cb45cf834c6604ba66c506~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1388&h=844&s=525102&e=png&b=add9e6)

切换到另一个户型看下：

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6583b9be2604df39036b5798226d5b1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1384&h=1108&s=326354&e=png&b=aed9e6)

都没问题。

我们再用同样的方式把门的洞画出来：


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/add9d0a6e04741f580b807d20c72a968~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1376&h=994&s=214119&e=png&b=1f1f1f)

```javascript
item.doors?.forEach(async door => {
    const path = new THREE.Path();

    const { left } = door.leftBottomPosition;

    path.moveTo(left, 0);
    path.lineTo(left, item.depth);
    path.lineTo(left + door.width, item.depth);
    path.lineTo(left + door.width, 0);
    path.lineTo(left, 0);
    shape.holes.push(path);
})
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abbd162e9db8482d8fc4c7fd810109c9~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1230&h=1090&s=320499&e=png&b=aed9e6)

然后加上蓝色的矩形：


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/634ef67c0b8147abb86e51e2f15644d6~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1482&h=992&s=206162&e=png&b=1f1f1f)

```javascript
item.doors?.forEach(door => {
    const { left } = door.leftBottomPosition;

    const geometry = new THREE.PlaneGeometry(door.width, item.depth);
    const material = new THREE.MeshBasicMaterial({
        color: 'blue',
        side: THREE.DoubleSide
    });
    const doorLogo = new THREE.Mesh(geometry, material);
    doorLogo.position.x = left + door.width / 2
    doorLogo.position.y = 100;
    wall.add(doorLogo);
})
```


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fb23904df664172b09ae8d2dc22fccc~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1230&h=1048&s=318759&e=png&b=add9e6)


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/087ea5e942a441c7924e0aa8baf034e6~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1184&h=828&s=519272&e=png&b=aed9e6)

当然，门窗都用矩形不好区分，我们也画一个弧形：

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/394748f5db3740dd87a92a692e08a401~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1096&h=792&s=344766&e=png&b=eef0f1)


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3804d27a7f24b9f8531703b550fb650~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1300&h=990&s=187213&e=png&b=1f1f1f)

```javascript
const shape = new THREE.Shape();
shape.moveTo(0, 0);
shape.arc(0, 0,door.width, 0, Math.PI / 2);
shape.lineTo(0, 0);

const geometry = new THREE.ShapeGeometry(shape);
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/10e1510da3b84a5aa484a7c60e47fe50~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1276&h=898&s=521038&e=png&b=add9e6)

形状没啥问题，但中心点在左下角，所以位置改一下：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cacbdbde77b64cef9da4514315aa7103~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1262&h=894&s=172480&e=png&b=1f1f1f)

```javascript
doorLogo.position.x = left;
doorLogo.position.z = -100;
```
不需要再移动门宽度的一半了，并且往上移动一些距离，避免和地板重合，出现闪烁现象。


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9abe417c158e44f495eb5ed374ea0b2c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1214&h=848&s=517308&e=png&b=add9e6)


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b3befde2fbb4e98a2dcd7ea48fcb091~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1346&h=1100&s=323293&e=png&b=aed9e6)

这样，门就画好了。

改下颜色、透明度：


![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bea555681f3042cdb36edaad0392afe9~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1168&h=1324&s=236340&e=png&b=1f1f1f)

```javascript
color: '#aaa',
transparent: true,
opacity: 0.8,
```


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15e08d4ad1464070a7d91a3fcfc54f8a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1256&h=880&s=522264&e=png&b=add9e6)


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fc8f948365bf4a3faae5fdba74f2a23f~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1262&h=1124&s=319779&e=png&b=add9e6)

没啥问题。

看下整体效果：


![2025-06-26 21.27.41.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f8b6c7fd76e45a18f4b4a8cee870787~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=16474704&e=gif&f=46&b=a6d2e2)

和 3D 视图一一对应的平面图就画好了。

这里没开启墙隐藏，不是很习惯那种功能：

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e37895d7a92c4e1288518d15c165c742~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=962&h=508&s=72190&e=png&b=1f1f1f)

后面再开。

>案例代码上传了[小册仓库](https://github.com/QuarkGluonPlasma/threejs-course-code/tree/main/home-decoration-editor)


## 总结

这节我们加上了 2D 视图门窗的绘制。

首先在门窗的位置挖洞，这个洞只需要计算 left 和 win.width 就行，整个挖通。

然后在洞的位置加一个矩形 PlaneGeometry 或者 ShapeGeometry。

门窗画好后，下节我们来做尺寸标注。
