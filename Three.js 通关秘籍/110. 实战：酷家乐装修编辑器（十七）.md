上节实现了户型列表和户型切换：

![2025-06-27 23.22.54.gif](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72de13c3e9994dc7ac32db5429042117~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=4520770&e=gif&f=50&b=f7f7f7)

这节我们来写一下家具列表和家具导入。

首先我们找一个餐桌的模型：

https://sketchfab.com/search?q=dining+table&type=models

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48d3ad57482b4b85b2c708e8a5010ae5~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2064&h=1354&s=1398064&e=png&b=eeeded)

用这个：

https://sketchfab.com/3d-models/modern-dining-table-3c4acb271fdd44c785d68c55351d6ffe#download


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3efd0e2f10a44168965957daafed9297~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2194&h=1448&s=2884672&e=png&b=efefef)

下载下来放到 public 目录下：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48ef69bd1e0b4d0aacffe85dbda23722~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=630&h=474&s=45179&e=png&b=1c1c1c)

我们先加载下看下效果：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e56c61070d74e69b782dde2b666f146~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1168&h=692&s=143485&e=png&b=1f1f1f)

```javascript
const gltfLoader = new GLTFLoader();
gltfLoader.load('./dining-table.glb', (gltf) => {
    house.add(gltf.scene);
});
```


![2025-06-28 20.47.14.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a2e8141e7b34ed0a6fa6fadaf91d574~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=13092118&e=gif&f=26&b=e3f1f9)

加载出来了，但位置不大对。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cacd41e2d6d3488d85675f407b8e7b91~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1244&h=656&s=139169&e=png&b=1f1f1f)

改下位置，旋转角度。

```javascript
gltf.scene.position.x = 1500;
gltf.scene.position.z = 3000;
gltf.scene.rotateY(Math.PI / 2);
```


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3de12e1d7144d57835b1642ee62fa18~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1498&h=1176&s=927646&e=png&b=f3f3f3)

这样家具的位置就对了。

当然，我们现在是写死的，应该是存在 json 里动态渲染出来。


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/232153919e3b417ca61a91a603828de4~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=930&h=992&s=119920&e=png&b=1f1f1f)

```javascript
interface Furniture {
    modelUrl: string,
    position: {
        x: number,
        y: number,
        z: number
    },
    rotation: {
        x: number,
        y: number,
        z: number
    }
}

export interface State {
    data: {
        walls: Array<Wall>,
        floors: Array<Floor>,
        ceilings: Array<Ceiling>,
        furnitures: Array<Furniture>
    }
}
```
先在类型加一下。

不需要 scale，因为家具模型大小是不能放缩的，模型多大就是多大。

可以调位置和旋转。

然后我们在户型数据里加一下这部分：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8124ef550c384e25945562f572c41c5c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1044&h=996&s=107917&e=png&b=1f1f1f)

```javascript
furnitures: [
    {
        modelUrl: './dining-table.glb',
        position: {
            x: 1500,
            y: 0,
            z: 3000
        },
        rotation: {
            x: 0,
            y: Math.PI / 2,
            z: 0
        }
    }
]
```
渲染 3D 场景的时候渲染下家具：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/66439fbb836240bea228f8b7ea76174b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1374&h=1070&s=240529&e=png&b=1f1f1f)

去掉之前写死的代码，我们动态加载。

```javascript
data.furnitures.forEach(furniture => {
    const gltfLoader = new GLTFLoader();
    gltfLoader.load(furniture.modelUrl, (gltf) => {
        house.add(gltf.scene);
        gltf.scene.position.set(
            furniture.position.x,
            furniture.position.y,
            furniture.position.z
        );
        gltf.scene.rotation.x = furniture.rotation.x;
        gltf.scene.rotation.y = furniture.rotation.y;
        gltf.scene.rotation.z = furniture.rotation.z;
    });
})
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6920ee9665e24b4ab64412b7126ebebd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1508&h=1446&s=796459&e=png&b=f8f8f8)

渲染没问题。

在另一个户型也加一下家具数据：


![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d2259d4daaf439d89b3108ece9f67e6~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1000&h=996&s=102209&e=png&b=1f1f1f)

```javascript
furnitures: [
    {
        modelUrl: './dining-table.glb',
        position: {
            x: 1500,
            y: 0,
            z: 3000
        },
        rotation: {
            x: 0,
            y: Math.PI / 2,
            z: 0
        }
    }
]
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/033f1b6dabb149df8dbb26e15a7325a8~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2064&h=1508&s=1611690&e=png&b=f9f9f9)

也渲染出来了。

这样我们就实现了家具数据的保存和动态渲染。

有了家具之后，开启墙隐藏功能看起来更方便：


![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f580f677d3ce4a53a5875437d240a0a7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1050&h=520&s=84478&e=png&b=1f1f1f)


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67e27457f0e84d0dab6bf76cb4a0eecf~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2152&h=1514&s=1455542&e=png&b=fafafa)

相机角度还是有点高，我们调低一点：


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f5ff1b5377884efb86b697228a3ea3d5~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1112&h=462&s=96435&e=png&b=1f1f1f)

```javascript
camera.position.set(6000, 4000, 6000);
```

![2025-06-28 22.11.24.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/85d932e2bb154af6b73e138f9efe8c67~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2362&h=1398&s=12180491&e=gif&f=30&b=f4f3f3)

这样就好多了。

>案例代码上传了[小册仓库](https://github.com/QuarkGluonPlasma/threejs-course-code/tree/main/home-decoration-editor)


## 总结

这节我们实现了家具导入。

从 sketchfab.com 找的家具模型，然后在 json 里保存了家具数据，包括 url、position、rotation。

渲染的时候动态渲染家具并设置位置、旋转角度就好了。

家具导入之后，就可以做位置、角度的编辑了。
